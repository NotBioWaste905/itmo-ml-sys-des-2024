# ML System Design Doc - [RU]
## Дизайн ML системы - What to eat? \<MVP or Production System\> \<Номер\>

### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

- Бизнес-цель: Создание системы автоматического составления меню на заданный промежуток времени, использование которой позволит уменьшить количество выбрасываемых продуктов и оптимизировать траты времени и финансов на готовку.
- Почему станет лучше, чем сейчас, от использования ML: Персонализированный подход к каждому пользователю позволит уменьшить количество нерелевантных советов, а использование Computer Vision моделей упростит ведение статистики по использованию продуктов, что позволит уменьшить число людей бросающих использование приложения.
- Что будем считать успехом итерации с точки зрения бизнеса: Увеличение метрики retention и числа людей регулярно посещающих приложение и использующих такой функционал как "Photo to grocery list" и "Create a menu". Процент положительных ответов пользователей на вопрос "Было ли это меню релевантным?" > 75%.

#### 1.2. Бизнес-требования и ограничения  

- Краткое описание БТ и ссылки на детальные документы с бизнес-требованиями:
  - Система должна формировать персонализированное меню на неделю/месяц
  - Система должна учитывать имеющиеся продукты пользователя
  - Необходима функция распознавания продуктов по фото
  - Интеграция со списком покупок
  - Учет пищевых предпочтений и ограничений пользователя

- Бизнес-ограничения:
  - Время отклика системы не более 10 секунд
  - Поддержка только популярных продуктов, доступных в основных сетевых магазинах
  - Ограничение по размеру файлов отправляемых на сервер
  - Необходимость работы в оффлайн режиме для основных функций (генерация меню)

- Что мы ожидаем от конкретной итерации:
  - MVP с базовым функционалом распознавания продуктов
  - Формирование меню на неделю в соответствии с набором распознанных или введенных вручную продуктов
  - Базовая персонализация
    - Корректирование генерации с помощью оценки пользователя, учет его аллергий и предпочтений

- Описание бизнес-процесса пилота:
  - Запуск с ограниченной группой пользователей (20-50 человек), репрезентативной по пищевым предпочтениям (веганы, вегентарианцы) и аллергиям
  - Сбор обратной связи через опросы и метрики использования
  - Тестирование нагрузки на серверную инфраструктуру, выявление узких мест обработки пользовательских данных

- Критерии успешного пилота:
  - Точность распознавания продуктов > 90% (учитываются только наименования отдельных объектов, не учитывается их количество)
  - Retention rate после недели использования > 60%
  - Положительные отзывы о релевантности меню > 75%
  - Средний период генерации меню > 2 дней
  - Количество незаменимых нерелевантных продуктов в сгенерированном меню < 5%

- Возможные пути развития
    - Оптимизация работы CV моделей, перенос вычислений на пользовательские устройства

#### 1.3. Что входит в скоуп проекта/итерации, что не входит   

- На закрытие каких БТ подписываемся в данной итерации:
    - Распознавание продуктов
        - Распознавание основных категорий продуктов (овощи, фрукты, мясо, молочные продукты) по одной фотографии
        - Внесение дополненных пользователем данных по наличию продуктов в базу данных
    - Создание базовой рекомендательной системы для генерации меню
        - Генерация меню в расчете из 3 блюда/день из имеющихся продуктов
        - Учет базовых пищевых ограничений (вегетарианство, веганство), наличие "черного списка" для каждого пользователя
        - Генерация меню на срок от 1 до 5 дней 
    - Разработка механизма обратной связи для улучшения рекомендаций
        - Сбор оценок релевантности меню по пользователю
        - Учет отвергнутых рекомендаций для каждого пользователя

- Что не будет закрыто:
    - Распознавание количества продуктов на фото
    - Определение срока годности по фото этикетки
    - Распознавание редких или экзотических продуктов
    - Генерация меню более чем на неделю
    - Учет калорийности и пищевой ценности
    - Интеграция с онлайн-магазинами
    - Распознавание готовых блюд
    - Перегенерация меню с учетом обратной связи

- Описание результата с точки зрения качества кода и воспроизводимости решения:
  - Документированный код с покрытием тестами > 80%
  - CI/CD пайплайн для моделей CV
  - CI/CD пайплайн для алгоритмов генерации меню
  - Система сбора обратной связи
  - Версионирование данных и моделей
  - Автоматизированное тестирование API endpoints
  - Документация по развертыванию системы

- Описание планируемого технического долга (что оставляем для дальнейшей продуктивизации):
    - Масштабирование системы для большего числа пользователей
    - Интеграция с внешними API для получения информации о продуктах
    - Реализация офлайн-режима работы на endpoint устройстве

#### 1.4. Предпосылки решения  

- Описание бизнес-процесса пользователя:
    1. Пользователь фотографирует продукты в холодильнике/на кухне
    2. Система распознает продукты
    3. Пользователь уточняет и дополняет распознанные данные
    4. На основе распознанных продуктов и предпочтений формируется персонализированное меню
    5. Пользователь получает рекомендации по использованию продуктов и рецепты
    6. Система отслеживает использование продуктов и обновляет рекомендации

### 2. Методология

#### 2.1. Постановка задачи  

- Что делаем с технической точки зрения: рекомендательная система, поиск аномалий, прогноз, оптимизация, и др. `Data Scientist`  

#### 2.2. Блок-схема решения
